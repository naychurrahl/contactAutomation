<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Landing Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
      /* ---------- Base Reset ---------- */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      }

      body {
        min-height: 100vh;
        background: #0a0a0a;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #ffffff;
      }

      /* ---------- Container ---------- */
      .container {
        width: 100%;
        max-width: 560px;
        padding: 40px 28px;
      }

      /* ---------- Brand ---------- */
      .brand {
        font-size: 13px;
        font-weight: 800;
        letter-spacing: 3px;
        color: #ff3d00;
        margin-bottom: 28px;
      }

      /* ---------- Headline ---------- */
      .headline {
        font-size: 44px;
        font-weight: 900;
        line-height: 1.05;
        margin-bottom: 16px;
      }

      .subheadline {
        font-size: 17px;
        color: #b3b3b3;
        max-width: 480px;
        margin-bottom: 40px;
      }

      /* ---------- Form ---------- */
      .form-block {
        background: #ffffff;
        color: #000000;
        padding: 34px;
        border-radius: 6px;
        box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6);
      }

      .form-group {
        margin-bottom: 22px;
      }

      label {
        display: block;
        font-size: 12px;
        font-weight: 800;
        letter-spacing: 1px;
        margin-bottom: 8px;
      }

      /* ---------- Phone row ---------- */
      .phone-row {
        display: flex;
        gap: 8px;
        align-items: center;
      }

      /* ---------- Inputs ---------- */
      input {
        padding: 18px 14px;
        font-size: 15px;
        font-weight: 600;
        border: 2px solid #cfcfcf;
        border-radius: 4px;
        background: #f2f2f2;
        color: #000;
        transition: border 0.15s ease, background 0.15s ease;
      }

      input:focus {
        outline: none;
        border-color: #ff3d00;
      }

      input.error {
        border-color: #e74c3c !important;
        background-color: rgba(231, 76, 60, 0.08);
      }

      .country-code {
        width: 90px; /* fixed small width */
        text-align: center;
      }

      .phone-number {
        flex: 1;
      }

      .error-message {
        display: none;
        margin-top: 6px;
        font-size: 12px;
        font-weight: 600;
        color: #e74c3c;
      }
      /* ---------- CTA ---------- */
      button {
        width: 100%;
        margin-top: 10px;
        padding: 20px;
        font-size: 16px;
        font-weight: 900;
        letter-spacing: 1px;
        text-transform: uppercase;
        border: none;
        border-radius: 4px;
        background: #ff3d00;
        color: #ffffff;
        cursor: pointer;
        transition: transform 0.15s ease, box-shadow 0.15s ease;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 30px rgba(255, 61, 0, 0.5);
      }

      /* ---------- Privacy ---------- */
      .privacy {
        margin-top: 16px;
        font-size: 12px;
        color: #777;
        text-align: center;
      }

      /* ---------- Mobile ---------- */
      @media (max-width: 480px) {
        .headline {
          font-size: 34px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="brand">YOUR BRAND</div>

      <div class="headline">Take the First Step</div>

      <div class="subheadline">
        Leave your details and we’ll reach out personally.
      </div>

      <div class="form-block">
        <form>
          <div class="form-group">
            <label>NAME</label>
            <input type="text" placeholder="John Smith" required />
            <small class="error-message"></small>
          </div>

          <div class="form-group">
            <label>PHONE NUMBER</label>
            <div class="phone-row">
              <!-- Country code with datalist -->
              <input
                list="countryCodes"
                class="country-code"
                placeholder="+234"
                value="234"
                required
              />
              <small class="error-message"></small>
              <datalist id="countryCodes">
                <option value="+93">AF (+93)</option>
                <option value="+355">AL (+355)</option>
                <option value="+213">DZ (+213)</option>
                <option value="+1-684">AS (+1‑684)</option>
                <option value="+376">AD (+376)</option>
                <option value="+244">AO (+244)</option>
                <option value="+1-264">AI (+1‑264)</option>
                <option value="+1-268">AG (+1‑268)</option>
                <option value="+54">AR (+54)</option>
                <option value="+374">AM (+374)</option>
                <option value="+297">AW (+297)</option>
                <option value="+61">AU (+61)</option>
                <option value="+43">AT (+43)</option>
                <option value="+994">AZ (+994)</option>
                <option value="+1-242">BS (+1‑242)</option>
                <option value="+973">BH (+973)</option>
                <option value="+880">BD (+880)</option>
                <option value="+1-246">BB (+1‑246)</option>
                <option value="+375">BY (+375)</option>
                <option value="+32">BE (+32)</option>
                <option value="+501">BZ (+501)</option>
                <option value="+229">BJ (+229)</option>
                <option value="+1-441">BM (+1‑441)</option>
                <option value="+975">BT (+975)</option>
                <option value="+591">BO (+591)</option>
                <option value="+387">BA (+387)</option>
                <option value="+267">BW (+267)</option>
                <option value="+55">BR (+55)</option>
                <option value="+246">IO (+246)</option>
                <option value="+1-284">VG (+1‑284)</option>
                <option value="+673">BN (+673)</option>
                <option value="+359">BG (+359)</option>
                <option value="+226">BF (+226)</option>
                <option value="+257">BI (+257)</option>
                <option value="+237">CM (+237)</option>
                <option value="+1">CA (+1)</option>
                <option value="+238">CV (+238)</option>
                <option value="+236">CF (+236)</option>
                <option value="+235">TD (+235)</option>
                <option value="+56">CL (+56)</option>
                <option value="+86">CN (+86)</option>
                <option value="+57">CO (+57)</option>
                <option value="+269">KM (+269)</option>
                <option value="+242">CG (+242)</option>
                <option value="+243">CD (+243)</option>
                <option value="+682">CK (+682)</option>
                <option value="+506">CR (+506)</option>
                <option value="+385">HR (+385)</option>
                <option value="+53">CU (+53)</option>
                <option value="+357">CY (+357)</option>
                <option value="+420">CZ (+420)</option>
                <option value="+45">DK (+45)</option>
                <option value="+253">DJ (+253)</option>
                <option value="+1-767">DM (+1‑767)</option>
                <option value="+1-809">DO (+1‑809)</option>
                <option value="+593">EC (+593)</option>
                <option value="+20">EG (+20)</option>
                <option value="+503">SV (+503)</option>
                <option value="+240">GQ (+240)</option>
                <option value="+291">ER (+291)</option>
                <option value="+372">EE (+372)</option>
                <option value="+251">ET (+251)</option>
                <option value="+298">FO (+298)</option>
                <option value="+679">FJ (+679)</option>
                <option value="+358">FI (+358)</option>
                <option value="+33">FR (+33)</option>
                <option value="+594">GF (+594)</option>
                <option value="+689">PF (+689)</option>
                <option value="+241">GA (+241)</option>
                <option value="+220">GM (+220)</option>
                <option value="+995">GE (+995)</option>
                <option value="+49">DE (+49)</option>
                <option value="+233">GH (+233)</option>
                <option value="+350">GI (+350)</option>
                <option value="+30">GR (+30)</option>
                <option value="+502">GT (+502)</option>
                <option value="+224">GN (+224)</option>
                <option value="+245">GW (+245)</option>
                <option value="+592">GY (+592)</option>
                <option value="+852">HK (+852)</option>
                <option value="+36">HU (+36)</option>
                <option value="+354">IS (+354)</option>
                <option value="+91">IN (+91)</option>
                <option value="+62">ID (+62)</option>
                <option value="+98">IR (+98)</option>
                <option value="+964">IQ (+964)</option>
                <option value="+353">IE (+353)</option>
                <option value="+44">GB (+44)</option>
                <option value="+39">IT (+39)</option>
                <option value="+81">JP (+81)</option>
                <option value="+962">JO (+962)</option>
                <option value="+254">KE (+254)</option>
                <option value="+965">KW (+965)</option>
                <option value="+234">NG (+234)</option>
                <option value="+371">LV (+371)</option>
                <option value="+423">LI (+423)</option>
                <option value="+370">LT (+370)</option>
                <option value="+352">LU (+352)</option>
                <option value="+261">MG (+261)</option>
                <option value="+265">MW (+265)</option>
                <option value="+60">MY (+60)</option>
                <option value="+960">MV (+960)</option>
                <option value="+223">ML (+223)</option>
                <option value="+356">MT (+356)</option>
                <option value="+230">MU (+230)</option>
                <option value="+52">MX (+52)</option>
                <option value="+47">NO (+47)</option>
                <option value="+968">OM (+968)</option>
                <option value="+92">PK (+92)</option>
                <option value="+507">PA (+507)</option>
                <option value="+51">PE (+51)</option>
                <option value="+63">PH (+63)</option>
                <option value="+48">PL (+48)</option>
                <option value="+351">PT (+351)</option>
                <option value="+974">QA (+974)</option>
                <option value="+40">RO (+40)</option>
                <option value="+7">RU (+7)</option>
                <option value="+966">SA (+966)</option>
                <option value="+221">SN (+221)</option>
                <option value="+65">SG (+65)</option>
                <option value="+378">SM (+378)</option>
                <option value="+27">ZA (+27)</option>
                <option value="+34">ES (+34)</option>
                <option value="+46">SE (+46)</option>
                <option value="+41">CH (+41)</option>
                <option value="+886">TW (+886)</option>
                <option value="+66">TH (+66)</option>
                <option value="+90">TR (+90)</option>
                <option value="+380">UA (+380)</option>
                <option value="+971">AE (+971)</option>
                <option value="+1">US (+1)</option>
                <option value="+598">UY (+598)</option>
                <option value="+58">VE (+58)</option>
                <option value="+84">VN (+84)</option>
                <option value="+967">YE (+967)</option>
                <option value="+260">ZM (+260)</option>
                <option value="+263">ZW (+263)</option>
              </datalist>

              <input
                class="phone-number"
                type="tel"
                placeholder="81 123 890 23"
                required
              />
              <small class="error-message"></small>
            </div>
          </div>

          <div class="form-group">
            <label>EMAIL (OPTIONAL)</label>
            <input type="email" placeholder="john@email.com" />
            <small class="error-message"></small>
          </div>

          <button type="submit">Get Started</button>
        </form>

        <div class="privacy">No spam. Ever.</div>
      </div>
    </div>

    <script>
      // Base API URL
      const API_BASE = "http://127.0.0.1:5600";

      // Validity variables
      var validEmail = null;
      var validCountryCode = null;
      var validNumber = null;
      var validName = null;

      // --- Helper Functions ---
      function showError(input, message) {
        input.classList.add("error");
        const small = input.parentElement.querySelector(".error-message");
        if (small) {
          small.textContent = message;
          small.style.display = "block";
        }
      }

      function clearError(input) {
        input.classList.remove("error");
        const small = input.parentElement.querySelector(".error-message");
        if (small) {
          small.textContent = "";
          small.style.display = "none";
        }
      }

      function validateName() {
        let value = nameInput.value.trim();
        value = value.replace(/\s{2,}/g, " ");
        nameInput.value = value;
        validName = value;
        clearError(nameInput);
      }

      function validateEmail() {
        const value = emailInput.value.trim();

        if (value.length === 0) {
          clearError(emailInput);
          return;
        }

        if (!emailRegex.test(value)) {
          showError(emailInput, "Please enter a valid email address.");
        } else {
          validEmail = value;
          clearError(emailInput);
        }
      }

      function validateCountryCode() {
        let value = countryCodeInput.value.trim();
        if (value.startsWith("+")) value = value.slice(1);
        countryCodeInput.value = value;

        if (!/^\d+$/.test(value)) {
          showError(countryCodeInput, "Digits only");
        } else {
          validCountryCode = value;
          clearError(countryCodeInput);
        }
      }

      function validatePhoneBody() {
        const value = phoneBodyInput.value.trim();

        if (!/^\d+$/.test(value)) {
          showError(phoneBodyInput, "Digits only");
        } else {
          validNumber = "+" + validCountryCode + value;
          phoneBodyInput.value = value;
          clearError(phoneBodyInput);
        }
      }

      // API request
      async function apiRequest(endpoint, method = "GET", data = null) {
        const headers = { "Content-Type": "application/json" };
        //const token = getToken();
        //if (token) headers["Authorization"] = token;

        try {
          const response = await fetch(`${API_BASE}/${endpoint}`, {
            method,
            headers,
            body: data ? JSON.stringify(data) : null,
          });

          //console.log(response);

          return await response.json();
        } catch (error) {
          console.log(error);
        }
      }

      // --- Constants ---
      const nameInput = document.querySelector(
        'input[placeholder="John Smith"]'
      );
      const emailInput = document.querySelector('input[type="email"]');
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      const countryCodeInput = document.querySelector(".country-code");
      const phoneBodyInput = document.querySelector(".phone-number");

      // --- Event Listeners ---
      nameInput.addEventListener("change", validateName);
      emailInput.addEventListener("change", validateEmail);
      countryCodeInput.addEventListener("change", validateCountryCode);
      phoneBodyInput.addEventListener("change", () => validatePhoneBody());

      // --- Submit if all valid ---
      document.querySelector("form").addEventListener("submit", function (e) {
        e.preventDefault();

        validateName();
        validateEmail();
        validateCountryCode();
        validatePhoneBody();

        if (document.querySelectorAll("input.error").length > 0) {
          console.log(document.querySelectorAll("input.error").length);
        } else {
          console.log("Form is valid.");
          console.log("Name:", validName);
          console.log("Email:", validEmail);
          console.log("Phone:", validNumber);

          (async () => {
            const payload = {
              phone: validNumber,
              name: validName,
              email: validEmail,
            };
            
            const data = await apiRequest("/", "POST", payload);

            console.log(data);
          })();
        }
      });
    </script>
  </body>
</html>
